<!doctype html>
<html>
    <head>
        <title>Chatroom</title>
		<meta charset="utf-8" />
		<script src="https://cdn.wilddog.com/sdk/js/2.5.17/wilddog.js"></script>
        <script src="../js/jquery-3.2.1.min.js"></script>
		<script src="../js/jquery.xcolor.min.js"></script>
        <script>
            
            var t = new Date();
            var day = t.getDate();
            var time_h = t.getHours();
            var time_m = t.getMinutes();
            var time_s = t.getSeconds();
			var username = $(".textInput").val();
			
            (time_h.length < 1) ? time_hh = "0" + time_h : time_hh = time_h;/*如果不足2位，补0*/
            (time_m.length < 1) ? time_mm = "0" + time_m : time_mm = time_m;
            (time_s.length < 1) ? time_ss = "0" + time_s : time_ss = time_s;
            (day.length < 1) ? time_dd = "0" + day : time_dd = day;
				
            var time = time_hh + ":" + time_mm + ":" + time_ss;
			
			function tip(text,color) {
				var tipBox = document.getElementById("tipBox");
				var tipit=$("#tipBox");
				tipBox.innerHTML ="<br/>" + text + "<br/><br/>" ;
				$("#tipBox").css({
					backgroundColor:color,
					fontSize:"30px",
					marginLeft:"40%",
					marginRight:"40%",
					marginTop:"0%",
					marginBottom:"5%",
					textAlign:"center",
					opacity:"0",
				});
				tipit.animate({
					opacity:"0.8",
					bottom:"100px",
				},"slow");
			}
			
			var config = {
				authDomain: "https://wd6413466545jrbfqv.wilddogio.com",
				syncURL: "https://wd6413466545jrbfqv.wilddogio.com"};
			wilddog.initializeApp(config);
			var ref = wilddog.sync().ref("/web/chat/users");
			
			function login (user_name){
				// 创建一个用户， 如果用户已经存在，那退出
				//var userRef = wilddog.sync().ref("/users/" + user_name);
				/*var userRef = wilddog.sync().ref();
				userRef.transaction(
					function(currentData) {
						if (currentData === null) {
							return { name: username} 
						}
						else {
							console.log(username + 'is exist.');
							return; // 退出
						}
					}
				).then(function(result) {
					if (!result.committed) {
						console.log('用户名已存在');
					} 
					else {
						console.log('成功');
					}
					console.log(username + "'s data: ", result.snapshot.val());
				}
				).catch(function(err){
					console.log('transaction failed.', error);
				});*/
				
			}
        </script>
    </head>
</html>
